$.fn.afterLoadDatawithdata=function(){};$.fn.afterLoadData=function(){};$.fn.afterSave=function(){};$.fn.beforeSave=function(){return!0};jQuery.fn.preventDoubleClick=function(){$(this).on("click",function(n){var t=$(this);t.data("clicked")?(n.preventDefault(),n.stopPropagation()):(t.data("clicked",!0),window.setTimeout(function(){t.removeData("clicked")},1e3))});return this};$(document).ready(function(){$("*").dblclick(function(n){return n.stopPropagation(),n.preventDefault(),console.log("double-clicked but did nothing"),!1})});var commonManger=function(){var t="/api/general.aspx/",c=function(n,t,i){$(".modal-header h3").html('<i class="icon-edit"><\/i> '+n+"");$("#"+i+"").attr("data-operation",t);$("#"+i+"").modal({show:!0})},l=function(t,i,r,u){dataService.callAjax("Post",JSON.stringify(r),i,u,n)},a=function(n){$("#"+n+" .modal-body").find("input, textarea, button, select").attr("disabled","disabled")},v=function(n){$("#"+n+" .modal-body").find("input, textarea, button, select").removeAttr("disabled")},i=function(n,t,i){toastr.options={closeButton:!0,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"toast-top-right",preventDuplicates:!0,onclick:null};i=="warning"?toastr.warning(t,n):i=="danger"||i=="error"?toastr.error(t,n):i=="success"?toastr.success(t,n):toastr.info(t,n)},n=function(n,t,i){console.log(n,t,i)},f=function(n){var t=$("#"+(n?n:"aspnetForm"));return t.valid()},y=function(n){var t=0,i;$(".dataTables_filter input").unbind("keypress keyup").bind("keypress keyup",function(){var r=$(this);t=0;i||(i=setInterval(function(){if(t>=3){clearInterval(i);i="";var u=$(r).val();n.fnFilter(u);t=0}t++},200))})},p=function(n){$("#"+n+"").find("input:not(.noreset)").each(function(){if($(this).attr("id")&&!$(this).hasClass("hasfunction")&&!$(this).hasClass("noreset")){var t=$(this).attr("id"),n=$(this).prop("type");n=="text"||n=="number"||n=="email"||n=="date"?$(this).hasClass("current-date")?$(this).val(moment().format("DD/MM/YYYY")):$(this).hasClass("select2")?$(this).select2("data",null):$(this).val(""):n=="checkbox"?$(this).prop("checked",!0):n=="hidden"?$(this).val(value="0"):n=="textarea"&&($(this).hasClass("textareaSpecial")?CKEDITOR.instances[t].setData("<p><\/p>"):$(this).val(value=""))}});$("#"+n+"").find("select:not(.noreset)").each(function(){if($(this).attr("name")){var n=$(this).attr("id"),t=$(this).prop("type");t=="select-one"&&($("#"+n).val(""),$("#"+n).hasClass("chzn-select")&&($(".chzn-select").val(""),$(".chzn-select").trigger("chosen:updated")))}});$("#"+n+" textarea:not(.noreset)").val("")},w=function(n,t){var i=[];$("#"+t).find("select:not(.notfill)").each(function(){var n=$(this).attr("id");n&&i.push(n)});$.each(n,function(t,r){if(n.tbl_name!=150&&n.tbl_name!=160)for(var u=0;u<i.length;u++)r.tbl_name==u&&($("#"+i[u]+"").append("<option value='"+r.ID+"'>"+r.Name+"<\/option>"),$("#"+i[u]+"").hasClass("chzn-select")&&$("#"+i[u]+"").chosen().trigger("chosen:updated").trigger("liszt:updated"))})},b=function(r,u,f){var e=[],o=[],s=tableName+"_Delete";$("#"+deleteModalDialog).find(".removeField").text().toLowerCase().indexOf(",")>=0?e=$("#"+deleteModalDialog).find(".removeField").text().split(","):e.push($("#"+deleteModalDialog).find(".removeField").text());pKey.toLowerCase().indexOf(",")>=0?o=pKey.split(","):o.push(pKey);DTO={Ids:e,ActionName:s,Parm_name:o};r=$("#"+r);dataService.callAjax("Post",JSON.stringify(DTO),t+"Delete_Data",function(n){$(r).modal("hide");n.d.Status?f(n):i("خطأ بالحذف:","خطأ أثناء الحذف "+n.d.message)},n)},k=function(r,u,f,e,o,s){var h=[],c=[],l=e+"_Delete";String(s).indexOf(",")>=0?h=s.split(","):h.push(s);String(o).indexOf(",")>=0?c=o.split(","):c.push(o);DTO={Ids:h,ActionName:l,Parm_name:c};r=$("#"+r);dataService.callAjax("Post",JSON.stringify(DTO),t+"Delete_Data",function(n){$(r).modal("hide");n.d.Status?u(n):i("لم تتم عملية الحذف",n.d.message)},n)},d=function(r,u,f,e,o,s){var h=[],c=[],l=e+"_Delete";h.push(s);c.push(o);DTO={Ids:h,ActionName:l,Parm_name:c};r=$("#"+r);dataService.callAjax("Post",JSON.stringify(DTO),t+"Delete_Data",function(n){$(r).modal("hide");n.d.Status?u(n):i("لم تتم عملية الحذف",n.d.message)},n)},g=function(n,t){$("#"+t+"").find("input,select,textarea,label").each(function(){var t,i,r;$(this).attr("id")&&($(this).hasClass("notneed")||(ElementId=$(this).attr("id"),t=$(this).prop("type"),(t!="undefined"||t!="")&&(t=="text"||t=="hidden"||t=="number"||t=="email"||t=="date"||t=="textarea"?$(this).hasClass("textareaSpecial")?CKEDITOR.instances[ElementId].setData(n[ElementId]):$(this).hasClass("date-picker")?$(this).val(u(n[ElementId],$(this).attr("date-current-format"),$(this).attr("date-to-format"))):(i=n[ElementId]+"",i.toLowerCase().indexOf("date(")>0?$(this).val(e(n[ElementId])):$(this).val(value=n[ElementId])):t=="select-one"&&$("#"+ElementId).hasClass("showvalue")?$("#"+ElementId+" option").filter(function(){return $(this).text()===n[ElementId]}).attr("selected","selected"):t!="select-one"||$("#"+ElementId).hasClass("showvalue")?t=="checkbox"?$(this).prop("checked",n[ElementId]):$(this).is("label")&&($(this).hasClass("date-picker")?(r=u(n[ElementId],"M/D/YYYY","DD/MM/YYYY"),$(this).text(r)):$("#"+ElementId+"").text(n[ElementId])):($("#"+ElementId).val(n[ElementId]),$("#"+ElementId).hasClass("chzn-select")&&$("#"+ElementId).chosen().trigger("chosen:updated").trigger("liszt:updated")))))});$.fn.afterLoadData();$.fn.afterLoadDatawithdata(n)},nt=function(){var n=t+"load_goalble_list",r={funName:tableName+"_Properties"};dataService.callAjax("Post",JSON.stringify(r),n,function(n){var t=JSON.parse(n.d);bindListsOnForm(t,formName);bindListsOnForm(t,detailsForm)},function(n,t,r){var u=t+": "+r,f=JSON.parse(n.responseText).Message;i("danger",u,f)})},tt=function(){return today_date=new Date,today_Date_Str=(today_date.getDate()<10?"0":"")+(today_date.getMonth()<9?"0":"")+String(today_date.getMonth()+1)+""+String(today_date.getDate()+""+today_date.getFullYear())},it=function(n){var t=[];return $("#"+n).find("input,select,textarea").each(function(){$(this).attr("id")&&($(this).hasClass("notneed")||($(this).hasClass("notshow")?t.push("hide"+$(this).attr("id")):t.push($(this).attr("id"))))}),t},rt=function(n){var t=[];return $("#"+n+"").find("input,select,textarea").each(function(){$(this).attr("id")&&($(this).hasClass("notneed")||$(this).hasClass("notsave")||t.push($(this).attr("id")))}),t},ut=function(i,u,f,e,o,s,h,c){var l=[],a=[],v=r(u),y;a=v[0];l=v[1];y={values:l,actionName:h,Parm_names:a,fieldsDetails:o,valuesDetails:s,flage:c};dataService.callAjax("Post",JSON.stringify(y),t+"SaveDataMasterDetails",function(n){commonManger.showMessage("تم الحفظ بنجاح:",n.d.message);$.fn.afterSave(l);f(n)},n)},r=function(n){var t=[],i=[],r=[],f="";return $("#"+n).find("input,select,textarea").each(function(){var n,r,e,o;$(this).attr("id")&&($(this).hasClass("notneed")||(f=$(this).attr("id"),n=$(this).prop("type"),(n!="undefined"||n!="")&&(n=="text"||n=="hidden"||n=="number"||n=="email"||n=="date"||n=="tel"?($(this).hasClass("date-picker")?t.push(u($(this).val())):t.push($(this).val()),i.push($(this).attr("id"))):n=="hidden"?($(this).val()==""?t.push("0"):t.push($(this).val()),i.push($(this).attr("id"))):n=="select-one"?(t.push($(this).find("option:selected").val()),i.push($(this).attr("id"))):n=="checkbox"?($(this).prop("checked",function(n,i){t.push(i)}),i.push($(this).attr("id"))):n=="radio"?(r=$(this).attr("name"),e=$('input[name="'+r+'"]:checked').val(),t.push(e),i.push(r)):n=="textarea"&&($(this).hasClass("textareaSpecial")?(o=CKEDITOR.instances.Details.getData(),t.push(o),i.push($(this).attr("id"))):(t.push($(this).val()),i.push($(this).attr("id")))))))}),r.push(i,t),r},ft=function(u,e,o){var l,a;if($.fn.beforeSave()){var s=[],h=[],c=r(formName),v=tableName+"_Save";h=c[0];s=c[1];l={values:s,actionName:v,Parm_names:h};u=$("#"+u);a=f(e);a&&dataService.callAjax("Post",JSON.stringify(l),t+"saveDefaultData",function(n){$(u).modal("hide");n.d.Status?o(n):i("خطأ أثناء الحفظ",n.d.message);commonManger.ResetControls(formName)},n)}},et=function(u,e,o,s,h,c,l){var a=[],v=[],y=r(e),p;v=y[0];a=y[1];DTO={values:a,actionName:h,Parm_names:v,flage:c};u=$("#"+u);p=f(e);p?dataService.callAjax("Post",JSON.stringify(DTO),t+"saveData",function(n){n=n.d;$(u).modal("hide");n.Status?(o(n),l(n.serializdata),commonManger.showMessage("تم بنجاح:","تم الحفظ بنجاح:")):commonManger.showMessage("خطأ أثناء الحفظ",n.message);commonManger.ResetControls(e)},n):($(u).modal("hide"),i("حقول مطلوبة","برجاء التأكد من اختيار جميع الحقول الاجبارية."))},ot=function(){commonManger.showMessage("تم الحذف بنجاح.","تمت عملية الحذف بنجاح.");$("#listItems").DataTable().draw()},st=function(n){n=n.d;n.Status?(commonManger.showMessage("تم الحفظ بنجاح.","تمت عملية الحفظ بنجاح."),$("#listItems").dataTable().fnDraw()):commonManger.showMessage("لم يتم الحفظ.","خطأ فى الحفظ:"+n.messages)},ht=function(n){return n!==undefined&&n!==null&&n.length>0?n.replace(/[^\d.]/g,""):0},ct=function(){for(var t=[],n,r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<r.length;i++)n=r[i].split("="),t.push(n[0]),t[n[0]]=n[1];return t},lt=function(){for(var t=[],n,r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<r.length;i++)n=r[i].split("="),t.push(n[0]),t[n[0]]=n[1];return t},at=function(){return $(location).attr("href").split("/")},vt=function(n){return $(n).text()},e=function(n,t){if(n==null)return"";var i=new Date(parseInt(n.substr(6)));return t?i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear():i.getDate()+"/"+(i.getMonth()+1)+"/"+i.getFullYear()},yt=function(n,t){if(!n||n=="")return n;t===undefined&&(t="dd/MM/yyyy");return $.format.date(n,t)},u=function(n,t,i){if(!n||n=="")return"";t=t?t:"D/M/YYYY";i=i?i:"MM/DD/YYYY";var r=moment(n,t);return r.format(i)},pt=function(n,t,i){return t=t||".",i=i||2,n.toLocaleString().split(t)[0]+t+n.toFixed(i).split(t)[1]},wt=function(n){$("div.page-header h1 small").remove();$("div.page-header h1").append($(" <small>"+n+"<\/small>"))},bt=function(n,t){return $("#"+t).DataTable({sDom:"<'row'>t<'row'>",bDestroy:!0,bLengthChange:!1,bFilter:!1,searching:!1,retrieve:!0,paging:!1,data:n,drawCallback:function(){if($.isFunction($.fn.editable)){var n=this.api();$("a.editable",n.table().body()).editable({validate:function(n){return $.trim(n)===""?"مطلوب.":isNaN(n)?"رقم فقط!":void 0},url:function(n){return n.table=$(this).data("table"),n.id=$(this).data("id"),$.ajax({type:"POST",url:sUrl+"InlineEdit",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",dataType:"json",async:!0,cache:!1,timeout:1e4,success:function(n){$.fn.afterSave(n);commonManger.showMessage("تم الحفظ:","تم حفظ المبلغ بنجاح.")},error:function(){commonManger.showMessage("خطأ:","لقد حدث خطأ فى تنفيذ الإجراء.")}})}})}}})},kt=function(n){return n.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"")},dt=function(t,i){if(t&&$.isNumeric(t)){var r={amount:t,dollarDirham:i};dataService.callAjax("Post",JSON.stringify(r),sUrl+"Money2Arabic",function(n){$.fn.afterSave(n)},n)}},gt=function(n,t,i){var f=o(n.d),u=f.list,r=f.list1,e;r=r?$.map(r,function(n){return n}):[0];e={sEcho:t?t:0,iTotalRecords:r[0],iTotalDisplayRecords:r[0],aaData:$.isArray(u)?u:$.makeArray(u)};i(e)},ni=function(n,t){$("#"+n).prop("disabled",t)},ti=function(t,i,r){return $.ajax({type:"POST",url:r?r:sUrl+"InlineEdit",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",async:!0,cache:!1,timeout:1e4,success:function(n){i(n.d)},error:n})},ii=function(){var n=$("level").attr("content");return n==="1"?!0:!1},o=function(n){var t=LZString.decompressFromUTF16(n),i=$.parseXML(t);return $.xml2json(i)},ri=function(t,i,r){r=r?r:"GetDataList";dataService.callAjax("POST",JSON.stringify(t),sUrl+r,function(n){try{var t=LZString.decompressFromUTF16(n.d),r=$.parseXML(t),u=$.xml2json(r);i(u)}catch(f){i(n)}},n)},s=function(n,t,i,r){n=n?n:"GET";t=t?t:{};dataService.callAjax(n,t,i,r,commonManger.errorException)},h=function(n,t,i,r){var u,f;r=$.isArray(r)?r:$.makeArray(r);u=$.map(r,function(n){return $("<option />").text(n[i]).val(n[t])});console.log(n,t,i,r,u);f=$("#"+n);f.html($("<option />")).append(u);f.hasClass("select2")&&fi("#"+n)},ui=function(n,t,i,r){var u=function(n){h(t,i,r,n)};s(null,null,n,u)},fi=function(n){$(n).select2({language:"ar",placeholder:lang.PleaseChoose,allowClear:!0,dir:"rtl"})};return{showPopUpDialog:c,doWork:l,showMessage:i,searchData:y,applyValidation:f,disableAllFormElements:a,enableAllFormElements:v,ResetControls:p,Filllist:w,getDataForUpdate:g,getUrlVars:lt,getUrlSegment:at,returnFiledsNames:it,returnFiledsNamesToSave:rt,SaveDataMasterDetails:ut,Returncontrolsval:r,getCurrentDate:tt,saveData:et,saveDefaultData:ft,deleteDefaultData:b,deleteData:k,getNumbersFromString:ht,getQueryStrs:ct,getStringFromHTML:vt,errorException:n,formatJSONDate:e,formatCurrency:pt,showOptionPrintTitle:wt,deleteMultipleData:d,successDeleted:ot,formatJSONDateCal:yt,dateFormat:u,successSaved:st,fillLists:nt,populateDataTable:bt,seoUrl:kt,num2Arabic:dt,disableControl:ni,setData2Grid:gt,saveEditable:ti,fullRoles:ii,comp2json:o,postData:ri,getData:s,bindSelect:h,getSelect:ui}}();$.isFunction($.fn.editable)&&($.fn.editable.defaults.mode="inline",$("a[data-type=text].editable").editable({url:function(n){return n.table=$(this).data("table"),n.id=$(this).data("id"),$.ajax({type:"POST",url:sUrl+"InlineEdit",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",dataType:"json",async:!0,cache:!1,timeout:1e4,success:function(){},error:function(n){console.log("Error in Ajax!..",n)}})}}));